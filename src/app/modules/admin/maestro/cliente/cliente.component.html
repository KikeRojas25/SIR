<div class="flex flex-col flex-auto min-w-0">

  <!-- Header -->
  <div class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-4 sm:px-10 border-b bg-card dark:bg-transparent">
    <div class="flex-1 min-w-0">
      <div class="flex flex-wrap items-center font-medium">
        <div><a class="whitespace-nowrap text-primary-500">SIR</a></div>
        <div class="flex items-center ml-1 whitespace-nowrap">
          <mat-icon class="fuse-horizontal-navigation-item-icon" [svgIcon]="'heroicons_solid:chevron-right'"></mat-icon>
          <a class="ml-1 text-primary-500">Maestro</a>
        </div>
      </div>
      <div class="mt-1">
        <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate">Clientes</h2>
      </div>
    </div>
  </div>

  <!-- Buscador -->
<div class="grid grid-cols-1 sm:grid-cols-4 gap-4 px-4 pb-2">
    <div class="sm:col-span-2">
      <div class="p-input-icon-right w-full">
        <input pInputText [(ngModel)]="model.cliente" (ngModelChange)="onClienteChange($event)" 
               type="text" placeholder="Razón Social / RUC / Nombre Corto" class="w-full" />
        <i *ngIf="model.cliente" 
           class="pi pi-times cursor-pointer text-gray-400 hover:text-gray-600" 
           (click)="limpiarCliente()"></i>
      </div>
    </div>
    <div class="sm:col-span-1 flex items-end">
      <p-button severity="success" icon="pi pi-search" (click)="buscarCliente()" label="Buscar" class="w-full"></p-button>
    </div>
    <div class="sm:col-span-1 flex items-end">
      <p-button severity="info" icon="pi pi-plus" (click)="nuevo()" label="Nuevo" class="w-full"></p-button>
    </div>
  </div>

  <!-- Tabla -->
<div class="bg-white shadow-sm rounded-lg p-4 border mt-1">
  <h3 class="text-lg font-semibold mb-4">Listado de Clientes</h3>
  <p-table [value]="clientes" [loading]="loading" class="p-datatable-sm">

      <ng-template pTemplate="header">
        <tr>
          <th>TIPO DOCUMENTO</th>
          <th>N° DOCUMENTO</th>
          <th>NOMBRE / RAZÓN SOCIAL</th>
          <th>CELULAR</th>
          <th>EMAIL</th>
          <th>ACCIONES</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-cliente>
        <tr>
          <td>{{ cliente.tipoDocumento }}</td>
          <td>{{ cliente.numeroDocumento }}</td>
          <td>{{ cliente.nombre }}</td>
          <td>{{ cliente.celular }}</td>
          <td>{{ cliente.email }}</td>
          <td>
            <button pButton icon="pi pi-pencil" 
                    class="p-button-rounded p-button-info p-button-sm mr-2" 
                    (click)="editar(cliente)"></button>
            <button pButton icon="pi pi-trash" 
                    class="p-button-rounded p-button-danger p-button-sm" 
                    (click)="eliminar(cliente)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<!-- Modal -->
<p-dialog header="{{ isNuevo ? 'Nuevo Cliente' : 'Actualizar Cliente' }}"
          [(visible)]="displayDialog" 
          [modal]="true" 
          [style]="{width: '600px'}"> <!-- más ancho -->
  <div class="p-fluid grid grid-nogutter p-2 gap-3">

    <div class="field col-12 md:col-6">
      <label for="tipoDocumento">Tipo Documento</label>
      <p-dropdown [options]="tiposDocumento"
                  [(ngModel)]="selectedCliente.idTipoDocumento"
                  placeholder="Seleccionar tipo">
      </p-dropdown>
    </div>

    <div class="field col-12 md:col-6">
      <label for="numeroDocumento">N° Documento</label>
      <input id="numeroDocumento" type="text" pInputText [(ngModel)]="selectedCliente.numeroDocumento" />
    </div>

    <div class="field col-12 md:col-6">
      <label for="nombre">Nombre / Razón Social</label>
      <input id="nombre" type="text" pInputText [(ngModel)]="selectedCliente.nombre" />
    </div>

    <div class="field col-12 md:col-6">
      <label for="celular">Celular</label>
      <input id="celular" type="text" pInputText [(ngModel)]="selectedCliente.celular" />
    </div>

    <div class="field col-12">
      <label for="email">Email</label>
      <input id="email" type="text" pInputText [(ngModel)]="selectedCliente.email" />
    </div>
  </div>

  <p-footer>
    <div class="flex justify-end gap-2 w-full">
      <button pButton label="Cancelar" icon="pi pi-times" 
              (click)="displayDialog=false" class="p-button-secondary"></button>
      <button pButton label="Guardar" icon="pi pi-check" 
              (click)="guardar()" class="p-button-success"></button>
    </div>
  </p-footer>
</p-dialog>

<p-toast position="top-right"></p-toast>
<p-confirmDialog></p-confirmDialog>
