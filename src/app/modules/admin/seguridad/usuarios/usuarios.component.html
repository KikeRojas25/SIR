<div class="flex flex-col flex-auto min-w-0">
  <!-- ðŸ”¹ Encabezado -->
  <div
    class="flex flex-col sm:flex-row sm:items-center sm:justify-between p-6 sm:px-10 border-b bg-white"
  >
    <div class="flex-1 min-w-0">
      <div class="flex flex-wrap items-center font-medium">
        <a class="whitespace-nowrap text-primary-500">SIR</a>
        <div class="flex items-center ml-1 whitespace-nowrap">
          <i class="pi pi-angle-right text-gray-500 mx-1"></i>
          <a class="ml-1 text-primary-500">Maestro</a>
          <i class="pi pi-angle-right text-gray-500 mx-1"></i>
          <span class="ml-1">Usuarios</span>
        </div>
      </div>
      <div class="mt-2">
        <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight">
          Usuarios
        </h2>
      </div>
      
    </div>
  </div>
         
  <!-- ðŸ” Filtro -->
  <div class="p-4 space-y-6">
    <div class="flex items-center gap-4 mb-4">
      <div class="flex flex-col">
        <span class="p-input-icon-right w-96">
          <input
            pInputText
            [(ngModel)]="criterio"
            type="text"
            placeholder="Nombre / Correo / Usuario Red"
            class="w-full"
          />
          <i
            *ngIf="criterio"
            class="pi pi-times cursor-pointer text-gray-500"
            (click)="criterio=''; buscarUsuarios()"
          ></i>
        </span>
      </div>
      <div class="flex items-end gap-2">
        <p-button
          label="Buscar"
          icon="pi pi-search"
          (click)="buscarUsuarios()"
          severity="success"
        >
        </p-button>
        <p-button
          label="Nuevo"
          icon="pi pi-plus"
          (click)="nuevo()"
          severity="info"
        >
        </p-button>
      </div>
    </div>
  <div class="bg-white shadow-sm rounded-lg p-4 border mt-6">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold">Listado de Usuarios</h3>
    </div>

    <!-- ðŸ“‹ Tabla -->
    
    <p-table
      [value]="usuarios"
      class="p-datatable-sm"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 20]"
      sortMode="multiple"
      responsiveLayout="scroll"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="id">
            ID <p-sortIcon field="id"></p-sortIcon>
          </th>
          <th pSortableColumn="nombre">
            Nombre <p-sortIcon field="nombre"></p-sortIcon>
          </th>
          <th pSortableColumn="apellido">
            Apellido <p-sortIcon field="apellido"></p-sortIcon>
          </th>
          <th pSortableColumn="usuarioRed">
            Usuario Red <p-sortIcon field="usuarioRed"></p-sortIcon>
          </th>
          <th pSortableColumn="correo">
            Correo <p-sortIcon field="correo"></p-sortIcon>
          </th>
          <th pSortableColumn="sucursal">
            Sucursal <p-sortIcon field="sucursal"></p-sortIcon>
          </th>
          <th>Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-usuario>
        <tr>
          <td>{{ usuario.id }}</td>
          <td>{{ usuario.nombre }}</td>
          <td>{{ usuario.apellido }}</td>
          <td>{{ usuario.usuarioRed }}</td>
          <td>{{ usuario.correo }}</td>
          <td>{{ usuario.sucursal }}</td>
          <td class="acciones flex gap-2">
            <button
              pButton
              icon="pi pi-pencil"
              class="p-button-rounded p-button-info p-button-sm"
              (click)="editar(usuario)"
              pTooltip="Editar"
            ></button>
            <button
              pButton
              icon="pi pi-trash"
              class="p-button-rounded p-button-danger p-button-sm"
              (click)="eliminar(usuario)"
              pTooltip="Eliminar"
            ></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<!-- ðŸŸ¢ Modal Nuevo/Editar Usuario -->
<p-dialog
  [(visible)]="mostrarModal"
  [modal]="true"
  [style]="{ width: '450px' }"
  [closable]="true"
  (onHide)="cancelar()"
>
  <ng-template pTemplate="header">
    <h3>{{ editando ? 'Editar Usuario' : 'Nuevo Usuario' }}</h3>
  </ng-template>

  <div class="flex flex-col gap-3">
    <input
      pInputText
      [(ngModel)]="model.nombre"
      placeholder="Nombre"
      class="w-full"
    />
    <input
      pInputText
      [(ngModel)]="model.apellido"
      placeholder="Apellido"
      class="w-full"
    />
    <input
      pInputText
      [(ngModel)]="model.usuarioRed"
      placeholder="Usuario Red"
      class="w-full"
    />
    <input
      pInputText
      [(ngModel)]="model.correo"
      placeholder="Correo"
      class="w-full"
    />

    <!-- ðŸ”½ Dropdown Sucursal -->
    <p-dropdown
      [options]="sucursales"
      optionLabel="nombre"
      appendTo="body"
      optionValue="idSucursal"
      [(ngModel)]="model.idSucursal"
      placeholder="Seleccione una sucursal"
      class="w-full"
    >
    </p-dropdown>
  </div>

  <ng-template pTemplate="footer">
    <p-button
      label="Cancelar"
      icon="pi pi-times"
      (click)="cancelar()"
      severity="secondary"
    ></p-button>
    <p-button
      label="Guardar"
      icon="pi pi-check"
      (click)="guardar()"
      severity="success"
    ></p-button>
  </ng-template>
</p-dialog>
<p-toast position="top-right"></p-toast>
<p-confirmDialog></p-confirmDialog>